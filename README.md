# What is it?
Different than most of other health check tools, this application loads websites in [PhantomJS](http://phantomjs.org/) and uses [CasperJS](http://casperjs.org/) to mimic user interactions and verify the results. 

# Why? 
Most of the web applications today use are single page applications and their content is generated by javascript or a template frameworks. To ensure an application is still functioning, the best way is to load it in a browser and verify the functionalities. That is exactly what HealthCheck is doing.

#Overview of Architecture
Primary technologies used: 
* Backend: [NodeJS](https://nodejs.org/), [ExpressJS](http://expressjs.com/), [PhantomJS](http://phantomjs.org/), [CasperJS](http://casperjs.org/), [mongoose](http://mongoosejs.com/), [agenda](https://github.com/rschmukler/agenda), and [Bluebird](https://github.com/petkaantonov/bluebird)
* Frontend: [BackboneJS](http://backbonejs.org/), [RequireJS](http://requirejs.org/), [UnderscoreJS](http://underscorejs.org/), [JQuery](https://jquery.com/), and [Handlebars](http://handlebarsjs.com/), [socket.io](http://socket.io/), and [data.io](https://github.com/scttnlsn/data.io)

![Overview](https://www.lucidchart.com/publicSegments/view/54ff22f1-ac18-4a37-b665-234c0a00494a/image.jpeg)

# Installation Steps
* Spin up an Ubuntu instance and access to its console as root
* Update apt package registry
```sh
$ apt-get update
```
* Install mongodb 
* Install nodejs
```sh
$ apt-get install nodejs
```
* Create alias for nodejs as node
```sh
$ ln -s /usr/bin/nodejs /usr/bin/node
```
* Install node package manager (NPM)
```sh
$ apt-get install npm
```
* Install git client
```sh
$ apt-get install git
```
* Install libfontconfig (phantomjs secret dependency)
```sh
$ apt-get install libfontconfig
```
* Install forever globally for executing node as daemon
```sh
$ npm install -g forever
```
* Install phantomjs globally
```sh
$ npm install -g phantomjs
```
* Install casperjs globally and record the executable location
```sh
$ npm install -g casperjs
$ whereis casperjs
# casperjs: /usr/local/bin/casperjs
```
* Check out code from repository
```sh
$ git clone https://github.com/aduyng/health-check.git /var/www/node/health-check
```
* Change to root folder of health-check
```sh
cd /var/www/node/health-check
```
* Install node dependencies
```sh
cd /var/www/node/health-check
npm install
```
* Make changes on config.js
```sh
vim config.js
```
```javascript 
var path = require('path'),
    pkg = require('./package.json'),
    env = process.env.NODE_ENV || 'development';
module.exports = {
    production: {
       rootPath: __dirname,
        app: {
            name: pkg.name,
            fullName: 'Health Check',
            version: pkg.version
        },
        mongo: {
            url: '<URL TO YOUR MONGO DATABSAE>',
            debug: false
        },
        casper: {
            absolutePath: '<casperjs absolute path>'
        }
    }
};
```
* Start your server with forever
```sh
PORT=80 NODE_ENV=production forever start server.js
```
